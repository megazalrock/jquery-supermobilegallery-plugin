(function(){var e=function(){this.options={selectors:{next:".next",prev:".prev",images:".images",indicator:".indicator"},animation:{imageFadeDuration:400},other:{retinaImageLoader:"enable",visibleImageNum:3,autoLoadRetinaImage:!0,retinaImageSuffix:"_x2",snapDistance:80,imageSpace:20}},this.$={}};e.prototype.init=function(e,t){var n=this;t=t||{},$.extend(!0,n.options,t),n.$.wrap=$(e),n.$.next=n.$.wrap.find(n.options.selectors.next),n.$.prev=n.$.wrap.find(n.options.selectors.prev),n.$.images=n.$.wrap.find(n.options.selectors.images),n.$.imagesChildren=n.$.images.children(),n.$.indicator=n.$.wrap.find(n.options.selectors.indicator),n.$.indicatorChildren=n.$.indicator.children(),n.status="moveEnd",n.current=-1,n.length=n.$.imagesChildren.length,n.preparedImagesIndex=[],n.imageWidth=n.$.imagesChildren.eq(0).width(),n.imageSpace=n.options.other.imageSpace;var r=n.$.imagesChildren.css("transition-duration");r.indexOf("ms")!==-1?n.options.animation.duration=parseFloat(r):r.indexOf("s")!==-1&&(n.options.animation.duration=parseFloat(r)*1e3),n.posArray=[-n.imageWidth/2-n.imageSpace-n.imageWidth-n.imageSpace-n.imageWidth,-n.imageWidth/2-n.imageSpace-n.imageWidth,-n.imageWidth/2-n.imageSpace,n.imageWidth/2,n.imageWidth/2+n.imageSpace+n.imageWidth,n.imageWidth/2+n.imageSpace+n.imageWidth+n.imageSpace+n.imageWidth,n.imageWidth/2+n.imageSpace+n.imageWidth+n.imageSpace+n.imageWidth+n.imageSpace+n.imageWidth],n.$.imagesChildren.css({marginLeft:0,display:"block",left:n.posArray[6]});var i="ontouchend"in window?"touchend":"click";n.$.next.on(i,function(e){n.current+1<n.length?n.changeTo(n.current+1):n.changeTo(0)}),n.$.prev.on(i,function(e){n.current-1>=0?n.changeTo(n.current-1):n.changeTo(n.length-1)});var s=0;n.$.wrap.on("mousedown touchstart",function(e){s=e.pageX||e.originalEvent.touches[0].pageX,$(this).on("mousemove touchmove",function(e){n.drag((e.pageX||e.originalEvent.touches[0].pageX)-s)}).on("mouseleave mouseup touchend",function(){$(this).off("mousemove mouseleave mouseup touchmove touchend")})}),n.changeTo(0)},e.prototype.getPreparedImagesArray=function(e){var t=this,n=-3,r=t.options.other.visibleImageNum+1,i=[];for(;n<r;n+=1)n+e<0?i.push(t.length+e+n):n+e>=t.length?i.push(n+e-t.length):i.push(e+n);return i},e.prototype.changeTo=function(e){var t=this;t.preparedImagesIndex=t.getPreparedImagesArray(e);var n={duration:t.options.animation.duration,easing:t.options.animation.easing},r=0;t.current===-1&&(n.duration=0),t.$.wrap.off("mousemove mouseleave mouseup touchmove touchend"),t.$.indicatorChildren.eq(e).addClass("selected").end().not(":eq("+e+")").removeClass("selected"),t.move(),t.current=e},e.prototype.drag=function(e){var t=this,n=t.$.imagesChildren.eq(t.current),r=parseInt(n.css("left"),10);Math.abs(e)>t.options.other.snapDistance?e>0?t.current-1>=0?t.changeTo(t.current-1):t.changeTo(t.length-1):e<0&&(t.current+1<t.length?t.changeTo(t.current+1):t.changeTo(0)):t.move(e)},e.prototype.move=function(e){var t=this;e=e||0;var n=0,r=t.preparedImagesIndex.length,i=0;t.animationCounter=0;for(;n<r;n+=1){var s={left:t.posArray[n]+e};e?s.transitionDuration="0ms":n===0||n===r-1?s.transitionDuration="0ms":s.transitionDuration=t.options.animation.duration+"ms",t.loadImage(t.preparedImagesIndex[n]),t.$.imagesChildren.eq(t.preparedImagesIndex[n]).css(s)}e||setTimeout(function(){},t.options.animation.duraiton)},e.prototype.loadImage=function(e){var t=this,n=t.$.imagesChildren.eq(e).find("img");if(!n.data("isLoaded")){n.fadeTo(0,0).one("load",function(){n.fadeTo(t.options.animation.imageFadeDuration,1).data("isLoaded",!0)});var r=n.attr("data-src");window.devicePixelRatio>1&&t.options.other.autoLoadRetinaImage&&(r=r.replace(".jpg",t.options.other.retinaImageSuffix+".jpg")),n.attr("src",r)}},$.extend({superMobileGallery:function(t,n){return new e}}),$.fn.extend({superMobileGallery:function(t){return $(this).each(function(){var n=new e;n.init(this,t),$(this).data("superMobileGallery",n)}),this}}),$(function(){$("#js_gallery").superMobileGallery({selectors:{next:".js_next",prev:".js_prev"}})})})(jQuery);